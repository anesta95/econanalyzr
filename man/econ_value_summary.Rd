% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/econ_value_summary.R
\name{econ_value_summary}
\alias{econ_value_summary}
\title{Apply a function to an econanalyzr data frame's numeric column after date filtering}
\usage{
econ_value_summary(
  df,
  dates = NULL,
  date_range = NULL,
  val_col = "value",
  filter_type = c("inclusive", "exclusive"),
  .fun = mean,
  na_rm = TRUE,
  dates_tz = "UTC",
  empty_ok = FALSE,
  ...
)
}
\arguments{
\item{df}{A data frame validated by \code{\link[=check_econanalyzr_df]{check_econanalyzr_df()}}.}

\item{dates}{Optional \code{Date} (or \code{POSIXt}) scalar/vector; rows with \code{date \%in\% dates}
are included/excluded per \code{filter_type}. \code{POSIXt} is coerced to \code{Date} using \code{dates_tz}.}

\item{date_range}{Optional length-2 \code{Date}/\code{POSIXt} giving a closed range
\verb{[min(date_range), max(date_range)]}. Ignored if \code{dates} is provided.}

\item{val_col}{Column to operate on (must be numeric): tidy-select name.
Defaults to column name \code{value} that is standard with econanalyzr data frames.}

\item{filter_type}{\code{"inclusive"} (keep matches) or \code{"exclusive"} (drop matches).}

\item{.fun}{A function (or function name) applied to the pulled vector, e.g. \code{mean},
\code{median}, or \code{function(x) stats::quantile(x, c(.25,.5,.75))}.}

\item{na_rm}{Logical; if \code{TRUE} (default) remove \code{NA}s before calling \code{.fun}.}

\item{dates_tz}{Timezone for coercing \code{POSIXt} (dates or range) to \code{Date}. Default \code{"UTC"}.}

\item{empty_ok}{If \code{FALSE} (default) and the filter returns 0 rows, return \code{NA_real_}
with a warning. If \code{TRUE}, pass a length-0 vector to \code{.fun} (which may error).}

\item{...}{Extra arguments forwarded to \code{.fun}.}
}
\value{
Whatever \code{.fun} returns (often a scalar; may be a vector).
}
\description{
Filters an econanalyzr-valid data frame by either a set of membership dates
(\code{dates}) or a closed range (\code{date_range}), pulls a \strong{numeric} column, and
applies a user-supplied function \code{.fun} to that vector.
}
\details{
Rules:
\itemize{
\item If both \code{dates} and \code{date_range} are \code{NULL}, the whole data is used.
\item If both are supplied, a classed error is raised.
\item If the filter yields 0 rows and \code{empty_ok = FALSE}, returns \code{NA_real_} and warns.
\item If \code{na_rm = TRUE}, \code{NA}s are removed \emph{before} calling \code{.fun}.
}
}
\examples{
# Mean of 'value' for a set of dates
# econ_value_summary(
#   df, dates = as.Date(c("2025-01-01","2025-02-01")), .fun = mean
# )

# Median over a date range (exclusive: drop rows in range)
# econ_value_summary(
#   df,
#   date_range = as.Date(c("2025-01-01","2025-03-31")),
#   filter_type = "exclusive",
#   .fun = median
# )

# Vector result (quantiles)
# econ_value_summary(
#   df,
#   dates = unique(df$date),
#   .fun  = function(x) stats::quantile(x, c(.25,.5,.75))
# )

}
