% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils-econ_viz_dims.R,
%   R/utils-econ_viz_save_grdevices.R, R/utils-econ_viz_save_ragg.R,
%   R/utils-econ_viz_save_svglite.R, R/utils-make_file_name_date.R,
%   R/utils-make_metadata_vec.R, R/utils-sanitize_filename.R
\name{econ_viz_dims}
\alias{econ_viz_dims}
\alias{econ_viz_save_grdevices}
\alias{econ_viz_save_ragg}
\alias{econ_viz_save_svglite}
\alias{make_file_name_date}
\alias{make_metadata_vec}
\alias{sanitize_filename}
\title{Compute pixel and inch dimensions for visualization devices}
\usage{
econ_viz_dims(width, height, units, dpi)

econ_viz_save_grdevices(plt, outpath, ext, dims, bg, dpi)

econ_viz_save_ragg(plt, outpath, ext, dims, bg, dpi)

econ_viz_save_svglite(plt, outpath, ext, dims)

make_file_name_date(date_vec)

make_metadata_vec(df_text, na_token = "na", warn_all_na = TRUE)

sanitize_filename(x)
}
\arguments{
\item{width, height}{Numeric scalars: requested size.}

\item{units}{Character scalar: one of \code{"px"}, \code{"in"}, \code{"cm"}, \code{"mm"}.}

\item{dpi}{Resolution (passed as \code{res}).}

\item{plt}{A ggplot object to print.}

\item{outpath}{File path (including extension) to write to.}

\item{ext}{Lowercased extension; must be "svg".}

\item{dims}{List from \code{\link[=econ_viz_dims]{econ_viz_dims()}}: \code{width_in}, \code{height_in} (inches).}

\item{bg}{Background color (e.g., "white", "transparent").}

\item{date_vec}{A Date vector (POSIXt allowed; coerced to Date).}

\item{df_text}{Data frame of *_text columns.}

\item{na_token}{Token to use when a column is all NA.}

\item{warn_all_na}{If TRUE, warn when a column is all NA.}

\item{x}{A character vector (will be coerced via \code{as.character()}).}
}
\value{
A list with:
\itemize{
\item \code{width_in}, \code{height_in} (numeric, inches)
\item \code{width_px}, \code{height_px} (integer, pixels)
}

A character stem like \code{"2025-05-01"} or \code{"2025-05-01_2021-05-01"}.

Character vector of tokens in column order.

A character vector of sanitized filename stems, same length as \code{x}.
}
\description{
Converts user-supplied \code{width}, \code{height}, \code{units}, and \code{dpi} into:
\itemize{
\item integer pixel sizes (for raster devices, e.g., PNG/JPEG/TIFF), and
\item floating-point inch sizes (for vector devices, e.g., PDF/SVG).
}

Opens a base graphics device (png/jpeg/tiff/bmp/pdf/svg), prints the ggplot,
and closes the device. Raster devices use pixels + \code{res}; vector devices use inches.

Uses \code{ragg::agg_png()}, \code{ragg::agg_jpeg()}, or \code{ragg::agg_tiff()} for
high-quality raster output. Requires \strong{ragg} in Suggests.
This helper checks availability with \code{rlang::is_installed()} and never attaches ragg.

Uses \code{svglite::svglite()} for clean SVG output. Requires \strong{svglite} in Suggests.
Checks availability with \code{rlang::is_installed()} and never attaches svglite.

If there is exactly one unique non-NA date, return it as \code{YYYY-MM-DD}.
If there are multiple, return \code{maxDate_minDate} (both formatted \code{YYYY-MM-DD}).
Errors if there are no non-NA dates or if \code{date_vec} is not Date/POSIXt.

Produces a conservative, filesystem-friendly slug:
\itemize{
\item Lowercases the string.
\item Replaces any whitespace (one or more) with underscores.
\item Replaces any character not in \verb{[a-z0-9._-]} with underscores.
\item Collapses multiple underscores to a single underscore.
\item Trims leading/trailing underscores and dots.
}
}
\details{
This is used by the various econanalyzr visualization savers to normalize sizing
regardless of which graphics backend is chosen.

This does \strong{not} add an extension; you can append e.g. \code{".csv"} afterward.
\code{NA} inputs are returned as \code{NA}.
}
\keyword{internal}
